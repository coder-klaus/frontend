## 创建

```js
import fs from 'node:fs/promises'

// 1. 创建目录
//  recursive: true => 递归创建
await fs.mkdir('./foo/bar/baz', { recursive: true })

// 2. 删除目录
//   默认只能删除空目录
//   如果目录不为空，则需要使用 recursive: true 选项进行递归删除
await fs.rmdir('./foo', { recursive: true })
```



## 读取

```js
import fs from 'node:fs/promises'

// 读取目录内容
// 1. 默认只返回目录第一层对应的文件和目录
// 2. 对应的值是字符串类型值
const dir = await fs.readdir('./foo')
console.log(dir)
```

```js
import fs from 'node:fs/promises'

// 可以通过 withFileTypes 将文件和目录转换为 Dirent 对象
// 此时可以通过 isDirectory 和 isFile 判断是否为目录和文件
const dir = await fs.readdir('./foo', { withFileTypes: true })

dir.forEach(item => {
  if (item.isDirectory()) {
    // name属性表示文件名和目录名
    console.log('目录', item.name)
  } else {
    console.log('文件', item.name)
  }
})
```

所以如果要获取目录下所有文件和目录，则需要递归处理

```js
import fs from 'node:fs/promises'
import path from 'node:path'

async function readdir(dirPath, level = 0) {
  const items = await fs.readdir(dirPath, { withFileTypes: true })

  // 使用 for...of 循环确保异步操作按顺序执行
  // 如果使用 forEach 会导致异步操作顺序混乱
  for (const item of items) {
    const indent = '  '.repeat(level)
    const fullPath = path.join(dirPath, item.name)

    if (item.isDirectory()) {
      console.log(`${indent} ${item.name}/`)
      await readdir(fullPath, level + 1)
    } else {
      console.log(`${indent} ${item.name}`)
    }
  }
}

readdir('./foo')
```



## 重命名

```js
import fs from 'node:fs/promises'

// 重命名目录
await fs.rename('./foo/bar', './foo/bar2')

// 重命名文件
await fs.rename('./data.txt', './info.txt')

// 移动文件或目录，如果目标存在，则覆盖
await fs.rename('./info.txt', './foo/info.txt')
```

