Node 的许多核心 API 都采用事件驱动机制，并继承自 Event 模块。

简而言之，就是某个对象会触发事件，我们可以通过监听这些事件，在事件发生时执行指定的回调函数。

通常使用 on() 监听事件，使用 emit() 触发事件。

```js
import { EventEmitter } from 'node:events'

// 创建EventEmitter实例
const emitter = new EventEmitter();

emitter.on('customEvent', (...args) => {
  console.log('customEvent事件被触发', ...args)
});

emitter.emit('customEvent', 'hello', 'world')
```



很多时候，我们会将参数整合为一个对象方便维护，这个参数叫payload

```js
import { EventEmitter } from 'node:events'

// 创建EventEmitter实例
const emitter = new EventEmitter();

function handleCustomEvent(payload) {
  console.log('customEvent事件被触发', payload)
}

// 监听事件 => 别名 addListener
emitter.on('customEvent', handleCustomEvent);

// 触发事件
emitter.emit('customEvent', {
  name: 'why',
  age: 18
})

// 移除事件 => 需要传入相同的回调函数引用地址 => 别名 removeListener
emitter.off('customEvent', handleCustomEvent);
```



```js
import { EventEmitter } from 'node:events'

// 创建EventEmitter实例
const emitter = new EventEmitter();

// 监听事件
emitter.on('customEvent', () => {
  console.log('customEvent事件被触发')
});


// 获取事件名称
console.log(emitter.eventNames()) // [ 'customEvent' ]

// 获取事件监听器数量
console.log(emitter.listenerCount('customEvent')) // 1

// 获取事件监听器
console.log(emitter.listeners('customEvent')) // [ [Function: handleCustomEvent] ]

// 设置事件最大监听器数量 「 超出最大数，控制台抛出警告 」
emitter.setMaxListeners(2)

// 获取事件最大监听器数量 「 默认是10 」
console.log(emitter.getMaxListeners()) // 2
```



```js
import { EventEmitter } from 'node:events'

// 创建EventEmitter实例
const emitter = new EventEmitter();

// 只触发一次的事件
emitter.once('customEvent', () => {
  console.log('customEvent事件被触发')
});

// 触发事件
emitter.emit('customEvent');

// 触发事件
emitter.emit('customEvent');
```



```js
import { EventEmitter } from 'node:events'

// 创建EventEmitter实例
const emitter = new EventEmitter();

emitter.on('customEvent', () => {
  console.log('customEvent事件1')
});

// 在事件队列头部添加事件
emitter.prependListener('customEvent', () => {
  console.log('customEvent事件2')
});

// 在事件队列头部添加只触发一次的事件
emitter.prependOnceListener('customEvent', () => {
  console.log('customEvent事件3')
});

emitter.emit('customEvent');
/*
  customEvent事件3
  customEvent事件2
  customEvent事件1
*/
```

```js
// 移除所有 customEvent 事件
emitter.removeAllListeners('customEvent')

// 不传参数，移除所有事件
emitter.removeAllListeners()
```

