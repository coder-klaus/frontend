## 常见关系类型

| 关系类型 | 英文名       | 实现方式         | 例子         |
| -------- | ------------ | ---------------- | ------------ |
| 一对一   | One-to-One   | 唯一外键         | 用户与身份证 |
| 一对多   | One-to-Many  | 多方表存外键     | 客户与订单   |
| 多对多   | Many-to-Many | 中间表存两个外键 | 学生与课程   |



对于一对一 或者 一对多 直接通过表中对应字段就可以表现出来，但是对于多对多，只能新建一个中间表来进行描述

本质就是利用了分层架构，把多对多拆成两个一对多关系，查询和管理更方便



假设存在如下表结构

```sql
-- 学生表
CREATE TABLE students (
    student_id INT PRIMARY KEY,
    name VARCHAR(50)
);

-- 课程表
CREATE TABLE courses (
    course_id INT PRIMARY KEY,
    course_name VARCHAR(50)
);

-- 学生-课程关联表（多对多关系表）
CREATE TABLE student_course (
    student_id INT,
    course_id INT,
		-- 联合主键
    PRIMARY KEY (student_id, course_id),
		-- 外键可以存在多个
    FOREIGN KEY (student_id) REFERENCES students(student_id),
    FOREIGN KEY (course_id) REFERENCES courses(course_id)
);

-- 插入学生
INSERT INTO students (student_id, name) VALUES (1, 'Alice');
INSERT INTO students (student_id, name) VALUES (2, 'Bob');

-- 插入课程
INSERT INTO courses (course_id, course_name) VALUES (101, 'Math');
INSERT INTO courses (course_id, course_name) VALUES (102, 'English');

-- 插入学生选课关系
INSERT INTO student_course (student_id, course_id) VALUES (1, 101); -- Alice选了Math
INSERT INTO student_course (student_id, course_id) VALUES (1, 102); -- Alice选了English
INSERT INTO student_course (student_id, course_id) VALUES (2, 101); -- Bob选了Math
```



此时数据之间多对多就表现为

![image.png](https://s2.loli.net/2025/06/29/ZIoyTe9dOQPDps7.png) 



```sql
-- 多对多表拼接 => 拼接时可以给表起别名
SELECT * FROM students as s
	LEFT JOIN student_course as sc ON s.student_id = sc.student_id
	LEFT JOIN courses as c ON sc.course_id  = c.course_id;
	
-- 查询 Alice 选修的课程
 SELECT * FROM students as s
	LEFT JOIN student_course as sc ON s.student_id = sc.student_id
	LEFT JOIN courses as c ON sc.course_id  = c.course_id
	WHERE s.name = 'Alice';
	
-- 查询课程 101 的选修学生
	 SELECT * FROM students as s
	LEFT JOIN student_course as sc ON s.student_id = sc.student_id
	LEFT JOIN courses as c ON sc.course_id  = c.course_id
	WHERE c.course_id = 101;
```



