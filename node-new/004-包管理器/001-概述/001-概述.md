在没有包管理工具的时候，我们需要自己去下载对应库，手动引入对应库。删除或更新时，也需要手动进程处理，非常麻烦。

包管理工具是一种命令行工具，可以帮助我们将项目所需的第三方库安装到 `node_modules` 目录中，随后就能通过 ESM 或 CJS 的方式直接使用这些库。

包管理工具不仅能自动管理各种模块及其依赖关系，还能方便地升级模块版本，省去了手动维护依赖的繁琐工作。

Node.js 自带的包管理工具是 npm（Node Package Manager）。



简单来说，我们可以把想要共享的代码打包成库，发布到 npm 仓库（npm repository）。其他人在需要使用时，只需通过包管理工具从 npm 仓库下载即可直接使用。

此外，包管理工具还能自动更新依赖、指定依赖版本，并管理依赖之间的关系。例如，不同的库可能依赖同一个库的不同版本，包管理工具会自动下载并管理这些不同版本，避免冲突。

NPM 官网（[npmjs.com](https://www.npmjs.com/)）是一个用于查询 npm 仓库中包信息的网站，上面列出了所有已发布的库。

```shell
# 查看npm版本
npm --version
```



我们可以通过`npm install <pkg>`来安装项目依赖，其又可以分为 生产依赖 和 开发依赖

```shell
# 安装库到生产依赖 => install 可以简写为 i <=> npm i day.js
npm install day.js # <=> npm install day.js --save 「 --save 是默认值 」

# 安装到开发依赖 => 注意 D要大写
npm install webpack -D # <=> npm install webpack --save-dev
```

```shell
# 同时安装 生产依赖 和 开发依赖
npm install # 简写 npm i

# 仅安装 生产依赖
npm install --production
```



依赖又可以分为`全局依赖`和`局部依赖`

```shell
# 默认是局部安装
# 安装到运行该命令对应的工作目录中的node_modules目录下
# 只能在当前项目中使用
npm install day.js # 单个包
npm install day.js axios # 多个包

# 使用 -g 全局安装
# 主要用于安装工具类包，其会被安装到一个特殊目录中，这个目录被加入系统环境变量
# 这也就意味着，可以在命令行任何地方直接使用这些全局安装的工具类包
# 注意: 无论是CJS还是ESM, 在查找模块的时候，最终会找项目根目录下的node_modules，但不会去找这个全局目录
npm install -g webpack
```



```shell
# 卸载
npm uninstall day.js # 可以简写为 npm un day.js

# 重新编译 node_modules 目录下所有需要编译的 native 模块
# + Native 模块是用 C/C++ 编写的 Node.js 扩展，通常在安装时会生成对应平台的二进制文件（.node 文件）
# + 如果模块作者已经为主流平台预编译好了二进制文件，安装时会直接下载使用；如果没有适配的二进制包，则会在本地编译生成 .node 文件
# + 这些 native 模块主要用于为 Node.js 注入底层功能，本质上类似于系统的动态链接库
npm rebuild

# 根据 package.json 里的版本范围，升级依赖到允许的最新版本
npm update

# 清除 .npm 对应的缓存资源
npm cache clean 

# 查看npm的缓存资源目录
npm config get cache

# 查看 npm repository仓库地址 => 默认是 https://registry.npmjs.org/
npm config get registry
```



## npm link

`npm link`主要用于本地开发和调试 npm 包

+ 在库目录下执行`npm link`，会在全局`node_modules`中创建一个指向当前库的符号链接 「 默认名称即为库名 」
+ 在测试项目中执行`npm link <库名>`, 会在当前项目的`node_moudles`中创建一个符号链接指向全局`node_modules`中的对应链接

从而实现本地库的调试

```shell
全局 node_modules
└── my-lib (symlink)  ←─────┐
                            │
my-app/node_modules         │
└── my-lib (symlink)  ──────┘
```



如果需要取消链接

+ 先在测试项目中执行`npm unlink <库名>`
+ 再在库目录中执行`npm unlink`



