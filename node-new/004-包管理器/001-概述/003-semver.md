**Semver**（语义化版本控制，Semantic Versioning）是一种广泛采用的软件版本命名规范，旨在通过版本号来表达软件的变更类型，从而让开发者和用户能直观地了解新版本的兼容性和升级风险。

语义化版本号采用如下格式：

```shell
MAJOR.MINOR.PATCH # 主版本.次版本.修订号 <=> 大版本.小版本.补丁号
```

| 部分  | 说明                                                         | 例子变化      | 更新指令            |
| ----- | ------------------------------------------------------------ | ------------- | ------------------- |
| MAJOR | 1. 重大功能升级 <br />2. 升级了不向后兼容的功能<br />简单来说推荐版本更新，且更新后可能和旧版本不兼容 | 1.0.0 → 2.0.0 | `npm version major` |
| MINOR | 新增功能，但保持向后兼容时递增                               | 1.1.0 → 1.2.0 | `npm version minor` |
| PATCH | 修复 bug（向后兼容），不影响 API 时递增                      | 1.1.1 → 1.1.2 | `npm version patch` |

类似于 `npm version major` 这类命名，执行后

1. 根据现有版本号生成最新版本号
2. 修改`package.json`
3. 自动执行`git tag`打上对应标签



^ 和 ~ 的区别是这样的：

- ^：允许次版本（Y）和补丁版本（Z）更新，但主版本（X）不变。 => 锁主版本
- ~：只允许补丁版本（Z）更新，主版本（X）和次版本（Y）不变。=> 锁主版本和此版本

执行 `npm install` 时，npm 会自动装范围内最新的版本



## 先行版本

在 **Semver（语义化版本控制）** 规范中，**先行版本（Pre-release version）** 指的是在正式发布稳定版本之前，用于标记测试、预览、候选等阶段的版本。先行版本主要用于：

- 内部测试
- 公开测试（alpha/beta）
- 发布候选（rc, release candidate）



### 命名规则

- 先行版本号紧跟在主版本号、次版本号、修订号后，以连字符 `-` 连接。
- 可以包含字母、数字和点号（`.`），如 `alpha.1`、`beta.2`、`rc.1`。
- 先行版本号排序时，视为比没有先行版本号的正式版低。



### 常见的先行符标识

**Semver 规范**没有强制要求使用哪些特定的先行版本标识，具体名称可以自定义。

先行版本标识由字母、数字和点（`.`）组成，但不能以点开头。例如，`1.0.0-1` 和 `1.0.0-dev.1` 都是合法的先行版本号。

一般推荐使用 `<js变量名命名规则的标识符>.<数字>` 的方式来命名先行版本标识，这样更具语义化。例如，在内部项目中可以使用 `sit` 作为先行标识符（如 `1.0.0-sit.1`），并结合 CI 配置：当检测到 `sit` 先行标识时，将项目自动发布到测试环境。

当然，更推荐使用社区通用的命名（如 `alpha`、`beta`、`rc`），以便团队和用户理解版本所处的阶段。

| 标识  | 含义说明                                                     | 示例        |
| ----- | ------------------------------------------------------------ | ----------- |
| alpha | 内部测试版，功能可能不全，存在较多 bug，仅供开发团队内部测试。 | 1.0.0-alpha |
| beta  | 公测版，功能基本完整，主要用于公开测试，修复 bug，优化体验，可能仍有 bug。 | 1.0.0-beta  |
| rc    | beta测试后，所有功能已完成，除了小问题外，已经没有响应体验的大bug<br />目前处于观测阶段，如果没有重大问题，将升级为正式版本 | 1.0.0-rc    |

你可以在先行版本号后加数字或其他标识以区分不同阶段，例如：

- `1.0.0-alpha.1`
- `1.0.0-beta.2`
- `1.0.0-rc.3`



### 排序规则

1. 先行版本之间的比较，按点号分割为多个标识段，逐段比对，数字按数值比对，字母按ASCII顺序比对
2. 预发布版本优先级要低于正式版本

```md
1.0.0-alpha.1 < 1.0.0-alpha.beta < 1.0.0-beta < 1.0.0-beta.2 < 1.0.0-rc < 1.0.0
```



### 运行命令

| 命令                                        | 作用描述                                      | 版本变化示例（当前1.0.0） |
| ------------------------------------------- | --------------------------------------------- | ------------------------- |
| `npm version prepatch`                      | 生成下一个预发布补丁版本，`preid`默认为`0`    | 1.0.0 → 1.0.1-0           |
| `npm version prerelease`                    | 递增当前预发布版本号                          | 1.0.1-0 → 1.0.1-1         |
| `npm version prepatch --preid <预发布标识>` | 生成下一个预发布补丁版本，假设`preid`为`beta` | 1.0.0 → 1.0.1-beta.0      |



## 兼容性

```shell
之前版本 -> 当前版本 -> 未来版本
```

向后兼容 => 当前版本兼容之前版本

向前兼容 => 当前版本兼容未来版本 「 很少见 」