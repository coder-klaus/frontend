## 创建目录

1. 命令不存在会创建目录
2. 目录存在，报错

```js
import fs from 'node:fs/promises'

await fs.mkdir('test')
```

```js
import fs from 'node:fs/promises'

/*
  默认情况下，不支持递归创建，创建时只能创建一个目录
  例如 目录结构如下:

  test
   └── foo

  可以创建 test/foo/baz => 只要创建 baz 即可
  不能创建 test/bar/baz => 要先创建 bar 再创建 baz
*/
await fs.mkdir('test/foo/baz')
```

```js
import fs from 'node:fs/promises'

// 如果需要递归创建目录，则必须设置 recursive 为 true
await fs.mkdir('test/foo/baz', { recursive: true })
```



## 读取目录

`目录结构`

```shell
.
├── foo
│   ├── bar
│   │   └── a.txt
│   ├── baz
│   │   └── b.txt
```



```js
import fs from 'node:fs/promises'

// 读取目录，不能递归读取
// 默认输出值为 文件名 和 目录名 组成的 字符串格式 数组
console.log(await fs.readdir('./foo')) // [ 'bar', 'baz', 'c.txt' ]
```



```js
import fs from 'node:fs/promises'

// 加上 withFileTypes 参数，可以返回 Dirent 对象
// Dirent 对象包含文件名、文件类型、文件路径等信息
const files = await fs.readdir('./foo', { withFileTypes: true })

console.log(files)
/*
  [
    Dirent { name: 'bar', parentPath: './foo', Symbol(type): 2 },
    Dirent { name: 'baz', parentPath: './foo', Symbol(type): 2 },
    Dirent { name: 'c.txt', parentPath: './foo', Symbol(type): 1 }
  ]
*/

for (const file of files) {
  // Dirent 对象的 isDirectory 方法可以判断文件是否是目录
  console.log(file.isDirectory())
}
```



```js
import fs from 'node:fs/promises'

// 手动封装 递归读取目录方法
async function readDir(path, level = 1) {
  const files = await fs.readdir(path, { withFileTypes: true })
  for (const file of files) {
    if (file.isDirectory()) {
      console.log(' '.repeat((level - 1) * 2) + file.name)
      await readDir(path + '/' + file.name, level + 1)
    } else {
      console.log(' '.repeat((level - 1) * 2) + file.name)
    }
  }
}

readDir('./foo')
/*
  bar
    a.txt
    b.txt
  baz
    c.txt
*/
```



## 重命名

```js
import fs from 'node:fs/promises'

// 重命名命令
fs.rename('./foo/bar', './foo/bar2')

// 重命名文件
fs.rename('./foo/c.txt', './foo/c.md')
```



## 删除目录

```js
import fs from 'node:fs/promises'

// 删除文件夹 「 递归删除 」
fs.rmdir('foo', { recursive: true })
```



## 删除文件

```js
import fs from 'node:fs/promises'

// 删除文件
fs.unlink('bar/a.txt')
```



## 判断文件或目录是否存在

```js
import fs from 'node:fs/promises'

try {
  // access 可以检查文件或目录是否存在
  // + 如果存在，则不报错
  // + 如果存在，则报错
  await fs.access('foo.txt')
} catch (e) {
  if (e instanceof Error) {
    console.error(e.message)
  } else {
    console.error(e)
  }
}
```

